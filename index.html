<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DriveTrack - Administración</title>
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="Style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> </head>
<body>
    <div id="login-container">
        <div class="login-box">
            <img src="assets/drivetrack_logo.png" alt="DriveTrack Logo" class="login-logo">
            <h2>Acceso DriveTrack</h2>
            <form id="login-form">
                <input type="text" id="username" placeholder="Usuario" required>
                <input type="password" id="password" placeholder="Contraseña" required>
                <button type="submit">Iniciar Sesión</button>
            </form>
            <p id="login-message" class="error-message"></p>
        </div>
    </div>

    <div id="admin-app-container" class="hidden app-role-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="assets/drivetrack_logo_white.png" alt="DriveTrack Logo" class="app-logo">
                <h3>DriveTrack Admin</h3>
            </div>
            <nav class="nav-menu">
                <a href="#" data-section="dashboard" class="active"><span class="material-icons">dashboard</span> Dashboard</a>
                <a href="#" data-section="vehicles"><span class="material-icons">directions_car</span> Vehículos</a>
                <a href="#" data-section="drivers"><span class="material-icons">people</span> Conductores</a>
                <a href="#" data-section="accounts"><span class="material-icons">receipt_long</span> Cuentas Semanales</a>
                <a href="#" data-section="alerts"><span class="material-icons">notifications_active</span> Alertas Mantenimiento</a>
            </nav>
            <button id="logout-button-admin" class="logout-button">Cerrar Sesión</button>
        </aside>

        <main class="content">
            <header class="topbar">
                <h1 id="admin-header-title">Dashboard</h1>
                <div class="user-info">
                    <span class="material-icons">account_circle</span> Admin
                    <div class="notifications">
                        <span class="material-icons notification-icon">notifications</span>
                        <span class="notification-badge hidden" id="notification-badge-admin">0</span>
                        <div class="notification-dropdown hidden" id="notification-dropdown-admin">
                            <h4>Notificaciones Recientes</h4>
                            <ul id="notification-list-admin"></ul>
                            <p class="no-notifications hidden">No hay notificaciones.</p>
                        </div>
                    </div>
                </div>
            </header>

            <section id="dashboard-section" class="app-section active-section">
                <div class="summary-cards">
                    <div class="card">
                        <span class="material-icons">directions_car</span>
                        <h3>Coches</h3>
                        <p id="total-cars">0</p>
                    </div>
                    <div class="card">
                        <span class="material-icons">people</span>
                        <h3>Conductores</h3>
                        <p id="total-drivers">0</p>
                    </div>
                    <div class="card">
                        <span class="material-icons">receipt_long</span>
                        <h3>Cuentas Pendientes</h3>
                        <p id="pending-accounts">0</p>
                    </div>
                    <div class="card">
                        <span class="material-icons">build</span>
                        <h3>Servicios por Vencer</h3>
                        <p id="upcoming-services">0</p>
                    </div>
                </div>

                <div class="recent-activity-placeholder">
                    <h2>Actividad Reciente</h2>
                    <p>Aquí se mostrarán las últimas acciones (ej. "Cuenta aprobada", "Vehículo añadido").</p>
                </div>
            </section>

            <section id="vehicles-section" class="app-section hidden">
                <h2>Gestión de Vehículos</h2>
                <div class="section-actions">
                    <button id="add-vehicle-btn"><span class="material-icons">add</span> Añadir Nuevo Vehículo</button>
                    <input type="text" id="vehicle-search" placeholder="Buscar vehículo...">
                </div>
                <table id="vehicles-table">
                    <thead>
                        <tr>
                            <th>Placas</th>
                            <th>Conductor Asignado</th>
                            <th>Fianza</th>
                            <th>Cuota Semanal</th>
                            <th>Estado de Servicio</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>

                <div id="add-vehicle-modal" class="modal hidden">
                    <div class="modal-content">
                        <h3>Añadir Nuevo Vehículo</h3>
                        <form id="add-vehicle-form">
                            <label for="new-plate">Placas:</label>
                            <input type="text" id="new-plate" required>
                            <label for="new-driver-assign">Asignar Conductor:</label>
                            <select id="new-driver-assign">
                                <option value="">Sin Asignar</option>
                                </select>
                            <label for="new-bond">Fianza:</label>
                            <input type="number" id="new-bond" step="0.01" required>
                            <label for="new-fee">Cuota Semanal:</label>
                            <input type="number" id="new-fee" step="0.01" required>
                            <label for="new-service-date">Fecha Último Servicio:</label>
                            <input type="date" id="new-service-date" required>
                            <label for="new-service-mileage">Kilometraje Último Servicio:</label>
                            <input type="number" id="new-service-mileage" required>
                            <button type="submit">Guardar Vehículo</button>
                            <button type="button" class="close-modal-btn">Cancelar</button>
                        </form>
                    </div>
                </div>
            </section>

            <section id="drivers-section" class="app-section hidden">
                <h2>Gestión de Conductores</h2>
                <div class="section-actions">
                    <button id="add-driver-btn"><span class="material-icons">person_add</span> Añadir Nuevo Conductor</button>
                    <input type="text" id="driver-search" placeholder="Buscar conductor...">
                    <select id="driver-filter-status">
                        <option value="all">Todos los estados</option>
                        <option value="active">Activo</option>
                        <option value="debt">Con Deuda</option>
                        <option value="no-vehicle">Sin Vehículo</option>
                    </select>
                </div>
                <table id="drivers-table">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Contacto</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>

                <div id="add-driver-modal" class="modal hidden">
                    <div class="modal-content">
                        <h3>Añadir Nuevo Conductor</h3>
                        <form id="add-driver-form">
                            <label for="new-driver-name">Nombre:</label>
                            <input type="text" id="new-driver-name" required>
                            <label for="new-driver-contact">Contacto:</label>
                            <input type="text" id="new-driver-contact" required>
                            <button type="submit">Guardar Conductor</button>
                            <button type="button" class="close-modal-btn">Cancelar</button>
                        </form>
                    </div>
                </div>
            </section>

            <section id="accounts-section" class="app-section hidden">
                <h2>Cuentas Semanales por Aprobar</h2>
                <div class="section-actions">
                    <input type="text" id="accounts-search" placeholder="Buscar cuenta...">
                    <button id="generate-new-accounts-btn"><span class="material-icons">refresh</span> Generar Cuentas (Simulado)</button>
                </div>
                <div id="pending-accounts-list" class="todo-list">
                    </div>
                <div class="accounts-history">
                    <h3>Historial de Cuentas Aprobadas</h3>
                    <table id="approved-accounts-table">
                        <thead>
                            <tr>
                                <th>Conductor</th>
                                <th>Período</th>
                                <th>Monto Aprobado</th>
                                <th>Deducciones</th>
                                <th>Fecha Aprobación</th>
                            </tr>
                        </thead>
                        <tbody>
                            </tbody>
                    </table>
                </div>

                <div id="review-account-modal" class="modal hidden">
                    <div class="modal-content">
                        <h3>Revisar Cuenta Semanal</h3>
                        <p>Conductor: <strong id="review-account-driver"></strong></p>
                        <p>Período: <strong id="review-account-period"></strong></p>
                        <label for="review-account-amount">Monto Calculado:</label>
                        <input type="number" id="review-account-amount" step="0.01" required>
                        <h4>Deducciones:</h4>
                        <div id="deductions-list">
                            </div>
                        <div class="add-deduction-form">
                            <input type="text" id="new-deduction-desc" placeholder="Descripción deducción">
                            <input type="number" id="new-deduction-amount" step="0.01" placeholder="Monto">
                            <button id="add-deduction-btn">Añadir Deducción</button>
                        </div>
                        <div class="modal-actions">
                            <button id="approve-account-btn" class="approve-btn">Aprobar Cuenta</button>
                            <button type="button" class="close-modal-btn">Cancelar</button>
                        </div>
                    </div>
                </div>
            </section>

            <section id="alerts-section" class="app-section hidden">
                <h2>Alertas de Mantenimiento Próximo</h2>
                <p class="no-alerts-message hidden">No hay alertas de mantenimiento actualmente.</p>
                <div id="maintenance-alerts-list">
                    </div>
            </section>
        </main>
    </div>

    <div id="driver-app-container" class="hidden app-role-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="assets/drivetrack_logo_white.png" alt="DriveTrack Logo" class="app-logo">
                <h3>DriveTrack Conductor</h3>
            </div>
            <nav class="nav-menu">
                <a href="#" data-section="driver-dashboard" class="active"><span class="material-icons">person</span> Mi Panel</a>
                <a href="#" data-section="driver-vehicle"><span class="material-icons">directions_car</span> Mi Vehículo</a>
                <a href="#" data-section="driver-accounts"><span class="material-icons">receipt_long</span> Mis Cuentas</a>
                <a href="#" data-section="driver-alerts"><span class="material-icons">notifications_active</span> Mis Alertas</a>
            </nav>
            <button id="logout-button-driver" class="logout-button">Cerrar Sesión</button>
        </aside>

        <main class="content">
            <header class="topbar">
                <h1 id="driver-header-title">Mi Panel</h1>
                <div class="user-info">
                    <span class="material-icons">account_circle</span> <span id="current-driver-name">Conductor</span>
                    <div class="notifications">
                        <span class="material-icons notification-icon">notifications</span>
                        <span class="notification-badge hidden" id="notification-badge-driver">0</span>
                        <div class="notification-dropdown hidden" id="notification-dropdown-driver">
                            <h4>Notificaciones Recientes</h4>
                            <ul id="notification-list-driver"></ul>
                            <p class="no-notifications hidden">No hay notificaciones.</p>
                        </div>
                    </div>
                </div>
            </header>

            <section id="driver-dashboard-section" class="app-section active-section">
                <h2>Bienvenido, <span id="driver-dashboard-name">Conductor</span></h2>
                <div class="summary-cards">
                    <div class="card">
                        <span class="material-icons">receipt_long</span>
                        <h3>Cuentas Pendientes</h3>
                        <p id="driver-pending-accounts">0</p>
                    </div>
                    <div class="card">
                        <span class="material-icons">build</span>
                        <h3>Próximo Servicio</h3>
                        <p id="driver-upcoming-service">N/A</p>
                    </div>
                </div>
                <div class="recent-activity-placeholder">
                    <h2>Últimas Novedades</h2>
                    <p>Aquí verás información relevante sobre tu vehículo y cuentas.</p>
                </div>
            </section>

            <section id="driver-vehicle-section" class="app-section hidden">
                <h2>Mi Vehículo Asignado</h2>
                <div id="driver-vehicle-details">
                    <p><strong>Placas:</strong> <span id="driver-vehicle-plate">N/A</span></p>
                    <p><strong>Fianza:</strong> <span id="driver-vehicle-bond">N/A</span></p>
                    <p><strong>Cuota Semanal:</strong> <span id="driver-vehicle-fee">N/A</span></p>
                    <p><strong>Último Servicio:</strong> <span id="driver-vehicle-last-service">N/A</span></p>
                    <p><strong>Kilometraje Último Servicio:</strong> <span id="driver-vehicle-last-mileage">N/A</span></p>
                    <p><strong>Estado de Servicio:</strong> <span id="driver-vehicle-status" class="status-badge">N/A</span></p>
                </div>
                <p id="no-vehicle-assigned" class="hidden error-message">No tienes un vehículo asignado actualmente.</p>
            </section>

            <section id="driver-accounts-section" class="app-section hidden">
                <h2>Mis Cuentas Semanales</h2>
                <h3>Cuentas Pendientes</h3>
                <div id="driver-pending-accounts-list" class="todo-list">
                    <p class="no-notifications">No tienes cuentas pendientes.</p>
                </div>
                <h3>Historial de Cuentas Aprobadas</h3>
                <table id="driver-approved-accounts-table">
                    <thead>
                        <tr>
                            <th>Período</th>
                            <th>Monto Aprobado</th>
                            <th>Deducciones</th>
                            <th>Fecha Aprobación</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </section>

            <section id="driver-alerts-section" class="app-section hidden">
                <h2>Mis Alertas de Mantenimiento</h2>
                <p class="no-alerts-message hidden">No hay alertas de mantenimiento para tu vehículo.</p>
                <div id="driver-maintenance-alerts-list">
                    </div>
            </section>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>